---
import TopBar from "../TopBar/TopBar.astro";
import { progress, isStartingUp } from "../../store.js";
import styles from "./style.module.scss";
import './global.css';
---

<script>
	import "../../scripts/register-components.ts";
</script>

	<style type="text/css">
		.toaster {
			position: absolute;
			top: 0;
			right: 0;
			width: 120px;
			height: auto;
			pointer-events: none;
			animation: flyToaster 8s linear infinite;
			will-change: transform;
		}

		@keyframes flyToaster {
			0% {
				transform: translate(0, 0) rotate(0deg);
				opacity: 1;
			}
			90% {
				opacity: 1;
			}
			100% {
				transform: translate(-100vw, 100vh) rotate(-15deg);
				opacity: 0;
			}
		}
	</style>

<main>
	<!-- <audio src="/classic/assets/sounds/computernoise.mp3" autoplay loop preload="auto"/> -->

	<div aria-hidden="false" class={styles.container} id="container" >
		<div
			id="startupContent"
			aria-hidden={!isStartingUp.value}
			class={styles.startupWindow}
		>
			<div class={styles.startupWindowContent}>
				<div class={styles.startupWindowInnerContent}>
					<div class={styles.patOsText}>
						<span class={styles.patOsText1}>Pat</span>
						<span class={styles.patOsText2}>OS</span>
					</div>
					<span class={styles.startingUpText}>Starting up...</span>

					<progress
						id="startuploader"
						max="100"
						value={String(progress)}
						class={styles.startingUpProgressBar}></progress>
						<small>(This is definitely a "sound on" experience.)</small>
				</div>
			</div>
		</div>

		<div id="mainContent" aria-hidden={isStartingUp.value}>
			<TopBar />
			<section class="mainWindow">
				<macintosh-dialog-box
					aria-hidden="true"
					id="openappdialog"
					class={styles.openAppDialog}
				>
					<span
						>KlickyTracker has both Android and iOS Apps! Which one
						would you like to see?</span
					>

					<div slot="icon">
						<img
							src={`${import.meta.env.BASE_URL}/assets/dialogimage.png`}
							width="55"
						/>
					</div>
					<div class={styles.dialogBoxFooter} slot="callToAction">
						<macintosh-button id="cancelbtn"
							>Cancel</macintosh-button
						>
						<macintosh-button id="androidbtn" data-type="primary"
							>Android...</macintosh-button
						>
						<macintosh-button id="iosbtn" data-type="primary"
							>iOS...</macintosh-button
						>
					</div>
				</macintosh-dialog-box>
				<div class={styles.iconSection}>
					<macintosh-icon-button name="hard-drive"
						>Patrick's Mac</macintosh-icon-button
					>
					<macintosh-icon-button name="folder"
						>My Apps</macintosh-icon-button
					>
				</div>

				<macintosh-window
					id="welcomewindow"
					data-header="Welcome!"
					x={500}
					y={100}
					width={"550px"}
					data-active="true"
					aria-hidden="false"
				>
					<section class={styles.mainWindow}>
						<h2 class={styles.mainHeader}>
							Hi! I'm <span class={styles.patrick}>Patrick.</span>
						</h2>
						<img
							class={styles.selfportrait}
							src={`${import.meta.env.BASE_URL}/assets/self.png`}
							width="200"
						/>
						<div class={styles.welcome}>
							<div>
								And welcome to my little web home! <img
									class={styles.houseemoji}
									src="/classic/assets/houseemoji.jpg"
								/>
							</div>

							<div>
								I'm a Front End & App Engineer who loves Design
								Systems, building cool apps, tending to
								aquariums and petting my cats, Luna and Ella. I
								love vintage design, especially Macintosh System
								7.5!
							</div>
						</div>
					</section>
				</macintosh-window>

				<macintosh-window
					id="myappswindow"
					data-header="My Apps"
					x={400}
					y={40}
					width={"400px"}
					aria-hidden="true"
					data-active="false"
					class={styles.myAppsWindow}
				>
					<section class={styles.mainWindow}>
						<h3 class={styles.mainHeader}>
							Here are a list of My Apps currently in App Stores!
						</h3>

						<div class={styles.appsList}>
							<macintosh-icon-button
								id="fishharmonyicon"
								src="/classic/assets/fishharmonymacicon.png"
								>Fish Harmony</macintosh-icon-button
							>

							<macintosh-icon-button
								id="klickytrackericon"
								src="/classic/assets/klickytrackermacicon.png"
								>KlickyTracker</macintosh-icon-button
							>
						</div>
					</section>
				</macintosh-window>

				<macintosh-window
					id="aboutwindow"
					data-header="About"
					x={250}
					y={0}
					width={"400px"}
					aria-hidden="true"
					data-active="false"
				>
					<section class={styles.mainWindow}>
						<h2 class={styles.mainHeader}>About this site</h2>

						<div id="aboutcontenteditable" class={styles.about}>
							<p>
								This site recreates the classic Macintosh System
								7.5 aesthetic entirely with HTML, CSS, and
								native Web Components, all stitched together
								using Astro. No heavy frameworks. I am a huge
								fan of all things Vintage Mac, and once even
								hosted my own website on an old Macintosh Color
								Classic using MacHTTP and MacTCP!

								<span class={styles.blinkingCursor}></span>
							</p>
						</div>
					</section>
				</macintosh-window>
			</section>
		</div>
	</div>
	

	<div id="sleepMode" class={styles.sleepMode} aria-hidden="true">
		<div id="stage" class={styles.stage}>
		</div>
	</div>
</main>

<script src="./main.js"></script>
<script src="./screensaver.js"></script>
